datasource db {
  provider             = "mysql"
  url                  = env("PLANETSCALE_PRISMA_DATABASE_URL")
  referentialIntegrity = "prisma"
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["referentialIntegrity"]
}

model Wallet {
  userId     BigInt  @unique
  username   String? @unique
  address    String  @unique
  privateKey String  @unique
}

model Chat {
  chatId BigInt @unique
  userId BigInt @unique
}

model GroupChat {
  chatId          BigInt            @id
  title           String
  createAt        DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  GroupChatMember GroupChatMember[]
}

model GroupChatMember {
  userId              BigInt
  username            String?
  groupChat           GroupChat             @relation(fields: [groupChatId], references: [chatId], onUpdate: NoAction, onDelete: NoAction)
  groupChatId         BigInt
  ActiveAirdropMember ActiveAirdropMember[]

  @@id([userId, groupChatId])
}

model ActiveAirdropMember {
  messageId       BigInt
  groupChatId     BigInt
  userId          BigInt
  activeAirdrop   ActiveAirdrop   @relation(fields: [messageId], references: [messageId], onUpdate: NoAction)
  groupChatMember GroupChatMember @relation(fields: [groupChatId, userId], references: [groupChatId, userId], onUpdate: NoAction)

  @@id([messageId, userId])
}

model ActiveAirdrop {
  messageId           BigInt                @unique
  chatId              BigInt
  ActiveAirdropMember ActiveAirdropMember[]
  amount              Float
  count               Int
}
